{% extends "structures/1column.html" %}

{% block title %}SAPU - Proyectos{% endblock %}

{% block main-content %}

{% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}

<div class="projects-container content container">

    <div class="projects-header view-header">
        <h1>PROYECTOS</h1>
        <a href="/modal/add/project" class="btn btn-info modal-summon">Agregar Proyecto</a>
    </div>

    <form action="{% url 'views.projects_render_view' %}" method="POST">
        <div>
            {% csrf_token %}
            {{ form_search_project.name }}
            <button type="submit"><i class="fa fa-search"></i></button>
        </div>
    </form>

    <div class="color-guide">
        <div class="color-in-time">A tiempo</div>
        <div class="color-complete">Completado</div>
        <div class="color-late">Retrasado</div>
        <div class="color-canceled">Cancelado</div>
        <div class="color-paused">Congelado</div>
    </div>

    <table class="table table-striped project-table">

        <thead>
            <th>Estado</th>
            <th>Fecha de Creación</th>
            <th>Nombre</th>
            <th>Código</th>
            <th>Tipo de proyecto</th>
            <th>Descripción</th>
            <th>Fecha Límite</th>
            <th>Foto</th>
            <th>Acciones</th>
        </thead>

    {% for project in projects %}
        <tr class="{{ project.state.name }}">
            <td> {{ project.state.name }}</td>
            <td>{{ project.creation_date }}</td>
            <td><a href="/proyectos/proyecto/{{ project.id }}">{{ project.name }}</a></td>
            <td>{{ project.id }}</td>
            <td>{{ project.project_type.name }}</td>
            <td>{{ project.description }}</td>
            <td>{{ project.deadline }}</td>
            <td>
                <img src="{{ project.photo.url }}">
                <a href="/modal/edit/project_photo/{{ project.id }}" class="modal-summon "><i class="fa fa-upload fa-2x" style="margin-right: 10px;"></i>Subir imagen</a>
            </td>
            <td id="editors">
                <a href="/modal/edit/project/{{ project.id }}" class="modal-summon"><i class="fa fa-pencil fa-2x"></i></a>
                <a href="#delete-project" class="modal-delete-summon" id="{{ project.id }}"><i class="fa fa-trash-o fa-2x"></i></a>
            </td>
        </tr>
    {% endfor  %}

    </table>

    {% if pagination %}
        <div class="pagination-outer row">
            <div class="pagination-inner col-md-4">
                {% if projects.has_previous %}
                    <a href="?page={{ projects.previous_page_number }}">
                        <i class="fa fa-chevron-left fa-2x"></i>
                    </a>
                {% endif %}

                <p>
                    Página {{ projects.number }} de {{ projects.paginator.num_pages }}
                </p>

                {% if projects.has_next %}
                    <a href="?page={{ projects.next_page_number }}">
                        <i class="fa fa-chevron-right fa-2x"></i>
                    </a>
                {% endif %}
            </div>
        </div>
    {% endif %}

</div> <!-- .projects-container -->

<div style="display:none">
    <div class="delete-modal" id="delete-project">
        <h6>¿Estás seguro de querer eliminar este proyecto?</h6>
        <a href="#" class="radius btn btn-info">Cancelar</a>
        <a href="/delete/project/" class="btn btn-danger submit-delete">Eliminar</a>
    </div>
</div>

{% endblock %}